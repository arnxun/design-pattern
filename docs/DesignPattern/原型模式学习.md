## 原型模式

### 1. 定义、特点

​     定义：用一个已经创建的实例作为原型，通过复制该原型对象来创建一个和原型相同或相似的新对象。在这里，原型实例指定了要创建的对象的种类。用这种方式创建对象非常高效，根本无须知道对象创建的细节。

这种模式是实现了一个原型接口，该接口用于创建当前对象的克隆。当直接创建对象的代价比较大时，则采用这种模式。例如，一个对象需要在一个高代价的数据库操作之后被创建。我们可以缓存该对象，在下一个请求时返回它的克隆，在需要的时候更新数据库，以此来减少数据库调用。

### 2. 结构

最简单形式：new_item = clone(source_item)

-----在python中，使用`copy.deepcopy()`函数来完成

原型模式包含以下主要角色：

1. 抽象原型类：规定了具体原型对象必须实现的接口。
2. 具体原型类：实现抽象原型类的 clone() 方法，它是可被复制的对象。
3. 访问类：使用具体原型类中的 clone() 方法来复制新的对象。

### 3. 实现

1. #### 当我们知道对象的某些部分会被变更但又希望保持原有对象不变时，通常需要对象的一个副本，此时重新创建原有对象没有意义。

2. #### 复制复杂对象。

   当创建复杂对象需要很多额外工作时，使用原型模式更方便更有效率。

3. #### 浅副本，深副本

​     在python中，使用`copy.copy()` 进行浅复制，使用`copy.deepcopy()`进行深复制

**浅副本**：浅副本构造一个新的复合对象后，（会尽可能地）将在原始对象中找到的对象的引用插入
新对象中。 

**深副本**：深副本构造一个新的复合对象后，会递归地将在原始对象中找到的对象的副本插入新对
象中。 

### 4. 应用场景

原型模式通常适用于以下场景。

- 对象之间相同或相似，即只是个别的几个属性不同的时候。
- 对象的创建过程比较麻烦，但复制比较简单的时候。

原型模式应用于很多软件中，如果每次创建一个对象要花大量时间，原型模式是最好的解决方案。很多软件提供的`复制(Ctrl + C)`和`粘贴(Ctrl + V)`操作就是原型模式的应用，复制得到的对象与原型对象是两个类型相同但内存地址不同的对象，通过原型模式可以大大提高对象的创建效率。

### 5. 扩展

原型模式可扩展为带原型管理器的原型模式，它在原型模式的基础上增加了一个原型管理器 `PrototypeManager` 类。该类用 `HashMap` 保存多个复制的原型，`Client` 类可以通过管理器的 get(String id) 方法从中获取复制的原型。

​       